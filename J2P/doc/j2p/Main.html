<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (1.8.0_11) on Thu May 03 13:23:17 CST 2018 -->
<title>Main</title>
<meta name="date" content="2018-05-03">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Main";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="class-use/Main.html">使用</a></li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../deprecated-list.html">已过时</a></li>
<li><a href="../index-files/index-1.html">索引</a></li>
<li><a href="../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../j2p/Graph.html" title="j2p中的类"><span class="typeNameLink">上一个类</span></a></li>
<li>下一个类</li>
</ul>
<ul class="navList">
<li><a href="../index.html?j2p/Main.html" target="_top">框架</a></li>
<li><a href="Main.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">j2p</div>
<h2 title="类 Main" class="title">类 Main</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>j2p.Main</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">Main</span>
extends java.lang.Object</pre>
<div class="block"><p>该类为第二次作业J2P的主类。
 <p>以下对整个程序的架构、翻译过程和Piglet语言缩进规范进行说明：
 
 <p>本程序沿袭了第一次作业中对MiniJava符号系统的封装，将MiniJava中的标识符抽象为以下类：
 <ul>
 <li><a href="../symbol/MIdentifier.html" title="symbol中的类"><code>MIdentifier</code></a>    标识符的父类，记录名称、所在行列
 <li>|---<a href="../symbol/MClass.html" title="symbol中的类"><code>MClass</code></a>     表示一个类，维护其方法、变量列表等
 <li>|---<a href="../symbol/MMethod.html" title="symbol中的类"><code>MMethod</code></a>    表示一个方法，维护其参数、变量列表等
 <li>|---<a href="../symbol/MVar.html" title="symbol中的类"><code>MVar</code></a>       表示一个变量，维护其类型
 </ul>
 <p>另外将MiniJava中的类型抽象为以下接口：
 <ul>
 <li><a href="../symbol/MType.html" title="symbol中的接口"><code>MType</code></a>                 类型的父接口，方法包括<a href="../symbol/MType.html#getName--"><code>MType.getName()</code></a>和<code>MType#canConvertTo(MType)</code>
 <li>|---<a href="../symbol/MClass.html" title="symbol中的类"><code>MClass</code></a>            类作为引用类型的承载者，继承该接口
 <li>|---<a href="../symbol/MType.html#IntType"><code>MType.IntType</code></a>     接口的常量实现，表示<code>int</code>类型
 <li>|---<a href="../symbol/MType.html#BooleanType"><code>MType.BooleanType</code></a> 接口的常量实现，表示<code>boolean</code>类型
 <li>|---<a href="../symbol/MType.html#ArrayType"><code>MType.ArrayType</code></a>   接口的常量实现，表示<code>int[]</code>类型
 <li>|---<a href="../symbol/MType.html#OtherType"><code>MType.OtherType</code></a>   接口的常量实现，表示<code>String[]</code>类型
 </ul>
 <p>和第一次作业相同，这样的封装可以十分优雅地建立起符号表，对于字符串的操作只在构建语法树的底层进行，耦合性很低。
 
 <p>另外，为了生成的Piglet代码有很高的可读性，以下定义了一套关于Piglet语句的缩进规范：
 <ul>
 <li>对于Goal和StmtExp中的StmtList，须缩进一个Tab宽度，若StmtList中某语句前有Label，则Label左端与缩进前对齐。
 <li>一个Piglet表达式若跨越多行，每一行必须与上一行开头对齐，即整个表达式在代码中应处于一个矩形区域内。
 <li>一个Piglet语句有多个参数时，若全为单行参数，则写在一行内，否则对于每一个多行的参数，其后面一个参数应与第一个参数开头对齐，这样保证了语句的参数列表处于一个矩形区域内。
 </ul>

 <p>本程序生成的Piglet程序全部遵循该规范，为此，对Piglet代码进行了以下封装：
 <ul>
 <li><a href="../piglet/PCode.html" title="piglet中的类"><code>PCode</code></a>                Piglet代码的抽象基类，定义了Piglet代码打印的基本规范
 <li>|---<a href="../piglet/PExp.html" title="piglet中的类"><code>PExp</code></a>             Piglet表达式的抽象基类，定义了Piglet表达式打印的基本规范
 <li>|---|---<a href="../piglet/PAllocate.html" title="piglet中的类"><code>PAllocate</code></a>    HAllocate
 <li>|---|---<a href="../piglet/PBinOp.html" title="piglet中的类"><code>PBinOp</code></a>       BinOp
 <li>|---|---<a href="../piglet/PCall.html" title="piglet中的类"><code>PCall</code></a>        Call
 <li>|---|---<a href="../piglet/PIdentifier.html" title="piglet中的类"><code>PIdentifier</code></a>  标识符，用来将函数名看做地址
 <li>|---|---<a href="../piglet/PInteger.html" title="piglet中的类"><code>PInteger</code></a>     整数
 <li>|---|---<a href="../piglet/PStmtExp.html" title="piglet中的类"><code>PStmtExp</code></a>     StmtExp
 <li>|---|---<a href="../piglet/PTemp.html" title="piglet中的类"><code>PTemp</code></a>        Temp
 <li>|---<a href="../piglet/PGoal.html" title="piglet中的类"><code>PGoal</code></a>            Goal
 <li>|---<a href="../piglet/PProcedure.html" title="piglet中的类"><code>PProcedure</code></a>       Procedure
 <li>|---<a href="../piglet/PStmt.html" title="piglet中的类"><code>PStmt</code></a>            Piglet语句的抽象基类，定义了Piglet语句打印的基本规范
 <li>|---|---<a href="../piglet/PCJumpStmt.html" title="piglet中的类"><code>PCJumpStmt</code></a>   CJump
 <li>|---|---<a href="../piglet/PErrorStmt.html" title="piglet中的类"><code>PErrorStmt</code></a>   Error
 <li>|---|---<a href="../piglet/PJumpStmt.html" title="piglet中的类"><code>PJumpStmt</code></a>    Jump
 <li>|---|---<a href="../piglet/PLabel.html" title="piglet中的类"><code>PLabel</code></a>       Label
 <li>|---|---<a href="../piglet/PLoadStmt.html" title="piglet中的类"><code>PLoadStmt</code></a>    HLoad
 <li>|---|---<a href="../piglet/PMoveStmt.html" title="piglet中的类"><code>PMoveStmt</code></a>    Move
 <li>|---|---<a href="../piglet/PNoOpStmt.html" title="piglet中的类"><code>PNoOpStmt</code></a>    Noop
 <li>|---|---<a href="../piglet/PPrintStmt.html" title="piglet中的类"><code>PPrintStmt</code></a>   Print
 <li>|---|---<a href="../piglet/PStoreStmt.html" title="piglet中的类"><code>PStoreStmt</code></a>   HStore
 <li>|---<a href="../piglet/PStmtList.html" title="piglet中的类"><code>PStmtList</code></a>        StmtList
 </ul>
 <p>每一个Piglet代码封装类中都有print方法可以在指定缩进位置打印该代码段，在具体的类中各自根据规范实现print方法，即可实现Piglet程序的完美缩进。
 
 <p>本程序主要分为五步，使用了三个Visitor进行遍历，前三步与第一次作业相同，具体如下：
 <ul>
 <li>1.使用<a href="../visitor/ClassVisitor.html" title="visitor中的类"><code>ClassVisitor</code></a>，遍历各个类的声明部分，将这些类加入符号表中
 <li>2.使用<a href="../visitor/MemberVisitor.html" title="visitor中的类"><code>MemberVisitor</code></a>，遍历各个类的成员变量和方法，以及各个方法的局部变量，将它们加入到符号表中
 <li>3.使用<code>SymbolTable#checkClassExtension()</code>，在符号表内部检查类的继承关系，在使用拓扑排序确定继承关系无环后，根据拓扑顺序进行类成员变量和方法的继承
 <li>4.使用<a href="../visitor/TranslateVisitor.html" title="visitor中的类"><code>TranslateVisitor</code></a>，遍历各个方法中的语句列表，将其翻译成<a href="../piglet/PCode.html" title="piglet中的类"><code>PCode</code></a>代码对象
 <li>5.对最终得到的<code>PCode</code>对象进行打印
 </ul>
 
 <p>在代码的翻译中有如下注意点：
 <ul>
 <li>关于原MiniJava中类型的处理：
                <ul>
                <li>int,boolean都看做Piglet中的整数，其中true看做1，false看做0
                <li>int[]在Piglet中使用一个地址来表示，该地址指向一块被分配的空间，开头四字节是数组长度n，后面4n字节是数组的实际内容
                <li>类实例在Piglet中使用一个地址来表示，该地址指向一块被分配的空间，开头四字节是一个地址，指向该实例的类的方法表，后面内容是该实例的属性表
                </ul>
 <li>关于方法多态和属性覆盖：
                <ul>
                <li>由于子类完全继承父类的方法，因此让子类方法表的前面部分与父类方法表一致，若有重载的方法，替换相应的方法地址即可，子类方法表的后面部分是子类所增加的方法。
                <li>由于子类属性仅仅覆盖父类属性，在调用父类方法时仍然可能用到父类属性，因此对于子类和父类的重名属性，不能进行替换，而是对子类所有属性都开辟额外的空间。
                </ul>
 <li>关于变量初始化：
                <ul>
                <li>类的成员变量在实例化该类时全部初始化为0
                <li>方法的局部变量在进入该方法时全部初始化为0
                <li>数组的内容在分配该数组时全部初始化为0
                </ul>
 <li>关于具体语句的翻译：
                <ul>
                <li>在使用引用型变量（包括类和数组）时，需要先检查非空
                <li>在对数组进行下标操作时，需要检查数组是否越界
                <li>在新建数组时，数组长度必须非负
                <li>对于&&表达式的处理，当左操作数为0时，不计算右操作数（短路与）
                </ul>
 </ul></div>
<dl>
<dt><span class="simpleTagLabel">作者:</span></dt>
<dd>castor_v_pollux</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>构造器概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="构造器概要表, 列表构造器和解释">
<caption><span>构造器</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">构造器和说明</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../j2p/Main.html#Main--">Main</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../j2p/Main.html#main-java.lang.String:A-">main</a></span>(java.lang.String[]&nbsp;args)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>从类继承的方法&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>构造器详细资料</h3>
<a name="Main--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Main</h4>
<pre>public&nbsp;Main()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="main-java.lang.String:A-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="class-use/Main.html">使用</a></li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../deprecated-list.html">已过时</a></li>
<li><a href="../index-files/index-1.html">索引</a></li>
<li><a href="../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../j2p/Graph.html" title="j2p中的类"><span class="typeNameLink">上一个类</span></a></li>
<li>下一个类</li>
</ul>
<ul class="navList">
<li><a href="../index.html?j2p/Main.html" target="_top">框架</a></li>
<li><a href="Main.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
